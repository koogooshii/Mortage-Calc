
<main class="container mx-auto p-4 sm:p-6 lg:p-8">
  <header class="flex justify-between items-center mb-6 flex-wrap gap-4">
    <h1 class="text-3xl font-bold text-white">Advanced Mortgage Calculator</h1>
    <div class="flex items-center gap-2 sm:gap-4 flex-wrap">
      <div class="p-1 rounded-lg bg-gray-700/50 flex items-center">
        <button
          (click)="setMode('compare')"
          class="px-3 py-1 text-sm font-semibold rounded-md transition-colors duration-200"
          [class.bg-cyan-600]="mode() === 'compare'"
          [class.text-white]="mode() === 'compare'"
        >
          Compare
        </button>
        <button
          (click)="setMode('refinance')"
          class="px-3 py-1 text-sm font-semibold rounded-md transition-colors duration-200"
          [class.bg-yellow-600]="mode() === 'refinance'"
          [class.text-white]="mode() === 'refinance'"
        >
          Refinance
        </button>
        <button
          (click)="setMode('history')"
          class="px-3 py-1 text-sm font-semibold rounded-md transition-colors duration-200"
          [class.bg-fuchsia-600]="mode() === 'history'"
          [class.text-white]="mode() === 'history'"
        >
          Loan History
        </button>
      </div>

      @if (mode() === 'compare') {
        <button
          (click)="addScenario()"
          [disabled]="scenarios().length >= 3"
          class="px-4 py-2 bg-cyan-600 hover:bg-cyan-700 disabled:bg-gray-600 disabled:cursor-not-allowed text-white font-semibold rounded-lg shadow-md transition-colors duration-200"
        >
          Add Scenario
        </button>
      }
    </div>
  </header>

  @switch (mode()) {
    @case ('compare') {
      <div
        class="transition-all duration-500 ease-in-out"
        [class]="gridClasses()"
      >
        @for (scenario of scenarios(); track $index; let i = $index) {
          <div class="w-full" [class.max-w-4xl]="scenarios().length === 1">
            <div class="bg-gray-800/50 backdrop-blur-sm rounded-xl shadow-2xl p-6 border border-gray-700">
              <header class="flex justify-between items-center mb-4">
                <h2 class="text-2xl font-semibold" [class]="'text-' + scenarioColors[i] + '-400'">
                  Scenario {{ i + 1 }}
                </h2>
                @if (i > 0) {
                  <button
                    (click)="removeScenario(i)"
                    class="px-3 py-1 bg-red-600 hover:bg-red-700 text-white text-sm font-semibold rounded-md shadow-sm transition-colors duration-200"
                  >
                    Remove
                  </button>
                }
              </header>
              <app-mortgage-calculator [color]="scenarioColors[i]" [scenarioCount]="scenarios().length" [scenarioIndex]="i" />
            </div>
          </div>
        }
      </div>
    }
    @case ('refinance') {
      <app-refinance-calculator />
    }
    @case ('history') {
      <app-loan-history />
    }
  }
</main>